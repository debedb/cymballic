* Refactor common code
* Allow either aws sso login or role if inside AWS
* Inference of parquet vs just metadata
